import{S as F,i as I,s as P,k as z,j as y,n as B,m as S,f as L,o as C,r as G,u as p,w as H,x as k,d as q,v as N,bb as W,aG as ee,V as ne,ae as X,H as te,T as ie,B as ae,l as Y,p as se,q as re}from"../../../chunks/vendor-202ba1b8.js";import{s as oe}from"../../../chunks/pageSeo-16c441c8.js";import{c as Z}from"../../../chunks/sanity-10ab6880.js";import{aX as le,q as ce,aY as ue,aZ as fe}from"../../../chunks/index-239f6385.js";import{C as de}from"../../../chunks/Challenge.generated-1c3b018c.js";import{L as me,C as he}from"../../../chunks/index-be9ec05e.js";import{M as pe}from"../../../chunks/index-caf95cd0.js";import{g as ke}from"../../../chunks/_sortContext-de024c04.js";import{l as ge,C as be}from"../../../chunks/_ChallengePage-d7d5b898.js";import{S as _e}from"../../../chunks/index-ed0c4dd7.js";import"../../../chunks/index-78395626.js";import"../../../chunks/groq-c0f2c31a.js";import"../../../chunks/goto-7d4088c3.js";import"../../../chunks/singletons-4b6b0cdf.js";import"../../../chunks/UserTags.generated-5f0e6eb8.js";import"../../../chunks/index-481a1ccf.js";import"../../../chunks/index-21535704.js";import"../../../chunks/context-88a045a1.js";import"../../../chunks/stores-5d02eee0.js";import"../../../chunks/types-0152c01c.js";import"../../../chunks/context-8abb743c.js";import"../../../chunks/index-f3ec258a.js";import"../../../chunks/index-101fb270.js";import"../../../chunks/utils-2db7bfcb.js";import"../../../chunks/query-string-674ed16b.js";import"../../../chunks/preload-helper-ec9aa979.js";import"../../../chunks/index-818f9b69.js";import"../../../chunks/index-6a61ceab.js";import"../../../chunks/shared-dc1dad71.js";import"../../../chunks/context-fa7439dc.js";import"../../../chunks/index-a6d5af8e.js";import"../../../chunks/resizeObserver-626ed4b4.js";import"../../../chunks/index-c5a03082.js";import"../../../chunks/variables-863c2d32.js";import"../../../chunks/index-7857f4f9.js";import"../../../chunks/index-b069bb96.js";import"../../../chunks/sessionInfo-312c9146.js";import"../../../chunks/UserSession.generated-47f74936.js";import"../../../chunks/makeFetchStore-06397d55.js";import"../../../chunks/requestClient-501ba30b.js";import"../../../chunks/helpers-3511dbf4.js";import"../../../chunks/index-c961e4f3.js";import"../../../chunks/index-ad8572b8.js";import"../../../chunks/index-4e53ca7a.js";import"../../../chunks/index-4371838a.js";import"../../../chunks/index-da75da01.js";import"../../../chunks/index-010e6e06.js";import"../../../chunks/index-041d0ef1.js";import"../../../chunks/index-5f6739d0.js";/* empty css                                                          *//* empty css                                                           */const E={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ChallengePublicList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sort"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ChallengeSort"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"challengeUnauthenticatedUserCount"}},{kind:"Field",name:{kind:"Name",value:"challengeUnauthenticatedUserList"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}},{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"sort"},value:{kind:"Variable",name:{kind:"Name",value:"sort"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Challenge"}}]}}]}},...de.definitions]};function ve(r){let n,t;return n=new he({props:{"data-test":"challenges-public",challengeList:r[1]}}),{c(){y(n.$$.fragment)},l(e){S(n.$$.fragment,e)},m(e,i){C(n,e,i),t=!0},p(e,i){const a={};i&2&&(a.challengeList=e[1]),n.$set(a)},i(e){t||(k(n.$$.fragment,e),t=!0)},o(e){p(n.$$.fragment,e),t=!1},d(e){N(n,e)}}}function je(r){let n,t;return n=new pe({}),{c(){y(n.$$.fragment)},l(e){S(n.$$.fragment,e)},m(e,i){C(n,e,i),t=!0},p:X,i(e){t||(k(n.$$.fragment,e),t=!0)},o(e){p(n.$$.fragment,e),t=!1},d(e){N(n,e)}}}function ye(r){let n,t,e,i,a;const u=[je,ve],c=[];function d(s,o){return s[3]?0:1}return n=d(r),t=c[n]=u[n](r),i=new me({props:{loadingMore:r[4],currentCount:r[1].length,totalCount:r[2]}}),i.$on("loadMore",r[7]),{c(){t.c(),e=z(),y(i.$$.fragment)},l(s){t.l(s),e=B(s),S(i.$$.fragment,s)},m(s,o){c[n].m(s,o),L(s,e,o),C(i,s,o),a=!0},p(s,[o]){let f=n;n=d(s),n===f?c[n].p(s,o):(G(),p(c[f],1,1,()=>{c[f]=null}),H(),t=c[n],t?t.p(s,o):(t=c[n]=u[n](s),t.c()),k(t,1),t.m(e.parentNode,e));const l={};o&16&&(l.loadingMore=s[4]),o&2&&(l.currentCount=s[1].length),o&4&&(l.totalCount=s[2]),i.$set(l)},i(s){a||(k(t),k(i.$$.fragment,s),a=!0)},o(s){p(t),p(i.$$.fragment,s),a=!1},d(s){c[n].d(s),s&&q(e),N(i,s)}}}var Se=globalThis&&globalThis.__awaiter||function(r,n,t,e){function i(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function c(o){try{s(e.next(o))}catch(f){u(f)}}function d(o){try{s(e.throw(o))}catch(f){u(f)}}function s(o){o.done?a(o.value):i(o.value).then(c,d)}s((e=e.apply(r,n||[])).next())})},Ce=24;function Ne(r){var{stuff:n}=r;return Se(this,void 0,void 0,function*(){try{var t=le.startAt,e=yield n.query(E,{offset:0,limit:Ce,sort:t},{requestPolicy:"network-only"});return{props:{challengesOperationStore:e,client:n.client}}}catch{return{props:{}}}})}function Oe(r,n,t){let e,i=X,a=()=>(i(),i=W(s,h=>t(12,e=h)),s);r.$$.on_destroy.push(()=>i());var u=this&&this.__awaiter||function(h,v,b,w){function K(O){return O instanceof b?O:new b(function(x){x(O)})}return new(b||(b=Promise))(function(O,x){function Q(j){try{T(w.next(j))}catch(A){x(A)}}function R(j){try{T(w.throw(j))}catch(A){x(A)}}function T(j){j.done?O(j.value):K(j.value).then(Q,R)}T((w=w.apply(h,v||[])).next())})},c,d;let{challengesOperationStore:s}=n;a();let{client:o=null}=n;var f=ke(),l=((c=e==null?void 0:e.data)===null||c===void 0?void 0:c.challengeUnauthenticatedUserList)||[],m=((d=e==null?void 0:e.data)===null||d===void 0?void 0:d.challengeUnauthenticatedUserCount)||0,_=e.variables,g;ee(s);var V=h=>{_=h,g&&g.unsubscribe(),g=te(o.query(E,_,{requestPolicy:"network-only"}),ie(v=>{var b=v==null?void 0:v.data;b&&(t(2,m=b.challengeUnauthenticatedUserCount),t(1,l=_.offset===0?b.challengeUnauthenticatedUserList:[...l,...b.challengeUnauthenticatedUserList])),t(3,$=!1),t(4,U=!1)}))},$=!1,U=!1;ce(f,h=>{var{current:v}=h;t(3,$=!0),V(Object.assign(Object.assign({},_),{offset:0,sort:v}))});var D=()=>u(void 0,void 0,void 0,function*(){t(4,U=!0),V(Object.assign(Object.assign({},_),{offset:l.length}))});ne(()=>{g&&g.unsubscribe()});const J=()=>D();return r.$$set=h=>{"challengesOperationStore"in h&&a(t(0,s=h.challengesOperationStore)),"client"in h&&t(6,o=h.client)},[s,l,m,$,U,D,o,J]}class we extends F{constructor(n){super();I(this,n,Oe,ye,P,{challengesOperationStore:0,client:6})}}function xe(r){let n,t;return n=new we({props:{client:r[1],challengesOperationStore:r[0]}}),{c(){y(n.$$.fragment)},l(e){S(n.$$.fragment,e)},m(e,i){C(n,e,i),t=!0},p(e,i){const a={};i&2&&(a.client=e[1]),i&1&&(a.challengesOperationStore=e[0]),n.$set(a)},i(e){t||(k(n.$$.fragment,e),t=!0)},o(e){p(n.$$.fragment,e),t=!1},d(e){N(n,e)}}}function $e(r){let n,t;return n=new be({props:{client:r[1],challengesOperationStore:r[0]}}),{c(){y(n.$$.fragment)},l(e){S(n.$$.fragment,e)},m(e,i){C(n,e,i),t=!0},p(e,i){const a={};i&2&&(a.client=e[1]),i&1&&(a.challengesOperationStore=e[0]),n.$set(a)},i(e){t||(k(n.$$.fragment,e),t=!0)},o(e){p(n.$$.fragment,e),t=!1},d(e){N(n,e)}}}function Ue(r){let n,t,e,i,a,u;const c=[r[3]];let d={};for(let l=0;l<c.length;l+=1)d=ae(d,c[l]);n=new _e({props:d});const s=[$e,xe],o=[];function f(l,m){return l[2]?0:1}return e=f(r),i=o[e]=s[e](r),{c(){y(n.$$.fragment),t=z(),i.c(),a=Y()},l(l){S(n.$$.fragment,l),t=B(l),i.l(l),a=Y()},m(l,m){C(n,l,m),L(l,t,m),o[e].m(l,m),L(l,a,m),u=!0},p(l,[m]){const _=m&8?se(c,[re(l[3])]):{};n.$set(_);let g=e;e=f(l),e===g?o[e].p(l,m):(G(),p(o[g],1,1,()=>{o[g]=null}),H(),i=o[e],i?i.p(l,m):(i=o[e]=s[e](l),i.c()),k(i,1),i.m(a.parentNode,a))},i(l){u||(k(n.$$.fragment,l),k(i),u=!0)},o(l){p(n.$$.fragment,l),p(i),u=!1},d(l){N(n,l),l&&q(t),o[e].d(l),l&&q(a)}}}var Te=globalThis&&globalThis.__awaiter||function(r,n,t,e){function i(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function c(o){try{s(e.next(o))}catch(f){u(f)}}function d(o){try{s(e.throw(o))}catch(f){u(f)}}function s(o){o.done?a(o.value):i(o.value).then(c,d)}s((e=e.apply(r,n||[])).next())})},M=oe["/casino/challenges"];function Tn(r){return Te(this,void 0,void 0,function*(){try{var n=r.page.path;if(r.session.isAuthenticated){var[t,e]=yield Promise.all([Z(r,n),ge(r,{variables:{type:ue.available,count:fe.available}})]);return{props:Object.assign(Object.assign({},e.props),{seo:t||M,isAuthenticated:!0})}}var[i,a]=yield Promise.all([Z(r,n),Ne(r)]);return{props:Object.assign(Object.assign({},a.props),{isAuthenticated:!1,seo:i||M})}}catch{return{props:{isAuthenticated:r.session.isAuthenticated,seo:M}}}})}function Ae(r,n,t){let{challengesOperationStore:e}=n,{client:i}=n,{isAuthenticated:a}=n,{seo:u}=n;return r.$$set=c=>{"challengesOperationStore"in c&&t(0,e=c.challengesOperationStore),"client"in c&&t(1,i=c.client),"isAuthenticated"in c&&t(2,a=c.isAuthenticated),"seo"in c&&t(3,u=c.seo)},[e,i,a,u]}class An extends F{constructor(n){super();I(this,n,Ae,Ue,P,{challengesOperationStore:0,client:1,isAuthenticated:2,seo:3})}}export{An as default,Tn as load};
